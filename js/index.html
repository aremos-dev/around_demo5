<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的情绪</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
</head>
<body>

    <!-- 开屏页 -->
    <div id="splash-screen" class="splash-screen">
        <img src="js/logo.png" alt="Logo" class="splash-logo">
    </div>

    <main class="main-content" id="main-content">
        <header class="app-header">
            <img src="js/20251110-104342.png" alt="User Avatar" class="avatar">
            <h1 id="app-title">我的情绪</h1>
            <div class="header-buttons">
                <button id="lang-toggle-btn" class="lang-btn" title="切换语言">
                    <svg t="1762830500000" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="28" height="28">
                        <path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" fill="#5C5C66"/>
                        <path d="M623.5 421.5c-4.9-9.3-18.8-9.3-23.7 0L512 618.9l-87.8-197.4c-4.9-9.3-18.8-9.3-23.7 0l-105 236c-3.3 7.5 0.4 16.3 8.3 19.6 7.9 3.3 16.7-0.4 20-8.3l93.3-210 87.8 197.4c4.9 9.3 18.8 9.3 23.7 0l87.8-197.4 93.3 210c3.3 7.9 12.1 11.6 20 8.3 7.9-3.3 11.6-12.1 8.3-19.6l-105-236z" fill="#5C5C66"/>
                        <path d="M749.5 349H274.5c-8.3 0-15 6.7-15 15s6.7 15 15 15h475c8.3 0 15-6.7 15-15s-6.7-15-15-15z" fill="#5C5C66"/>
                    </svg>
                </button>
                <button id="open-modal-btn" class="heart-btn">
                    <svg t="1762830022679" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4719" width="28" height="28"><path d="M961.206667 241.68A256.066667 256.066667 0 0 0 512 199.76 256 256 0 0 0 42.666667 341.333333c0 35.96 1.826667 66.606667 10.753333 99.293334 10.06 36.84 28.233333 72.96 57.193333 113.673333 30.993333 43.56 75.62 93.766667 136.44 153.48 63.013333 61.866667 145.153333 135.733333 251.133334 225.806667a21.333333 21.333333 0 0 0 27.626666 0c106-90.073333 188.12-163.94 251.133334-225.806667 60.82-59.713333 105.446667-109.92 136.44-153.48 28.96-40.713333 47.133333-76.833333 57.193333-113.673333 8.926667-32.666667 10.753333-63.333333 10.753333-99.293334a254.433333 254.433333 0 0 0-20.126666-99.653333zM512 889.333333c-194.706667-166.193333-308.073333-277.466667-366.613333-359.766666q-6.433333-9.026667-12-17.566667H234.666667a21.333333 21.333333 0 0 0 15.086666-6.246667l64.4-64.42 114.766667 229.526667A21.333333 21.333333 0 0 0 448 682.666667h1.126667a21.333333 21.333333 0 0 0 18.873333-13.84L578.8 373.333333l106.12 212.24a21.333333 21.333333 0 0 0 34.166667 5.546667L798.166667 512h92.413333q-5.546667 8.54-11.966667 17.566667C820.073333 611.866667 706.706667 723.14 512 889.333333z m402.566667-420H789.333333a21.333333 21.333333 0 0 0-15.086666 6.246667l-64.4 64.42-114.766667-229.54a21.333333 21.333333 0 0 0-39.08 2.046667L445.2 608.033333 339.08 395.793333a21.333333 21.333333 0 0 0-34.166667-5.546666L225.833333 469.333333h-116.4C87.553333 422.593333 85.333333 384.98 85.333333 341.333333c0-117.633333 95.7-213.333333 213.333334-213.333333 83.1 0 159.226667 48.813333 193.946666 124.353333a21.333333 21.333333 0 0 0 38.773334 0C566.106667 176.813333 642.233333 128 725.333333 128c117.633333 0 213.333333 95.7 213.333334 213.333333 0 43.646667-2.22 81.26-24.1 128z" fill="#5C5C66" p-id="4720"></path></svg>
                </button>
                <button id="open-health-modal-btn" class="health-btn">
                    <svg t="1762830404569" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7397" width="28" height="28"><path d="M981.333333 533.333333c0 247.426667-200.573333 448-448 448s-448-200.573333-448-448 200.573333-448 448-448 448 200.573333 448 448zM533.333333 128c-223.86 0-405.333333 181.473333-405.333333 405.333333s181.473333 405.333333 405.333333 405.333334 405.333333-181.473333 405.333334-405.333334-181.473333-405.333333-405.333334-405.333333z m144.493334 548.34a21.333333 21.333333 0 0 0-0.153334-30.166667L554.666667 524.433333V256a21.333333 21.333333 0 0 0-42.666667 0v277.333333a21.333333 21.333333 0 0 0 6.326667 15.16l129.333333 128a21.333333 21.333333 0 0 0 30.166667-0.153333z" fill="#5C5C66" p-id="7398"></path></svg>
                </button>
            </div>
        </header>

        <section class="mood-visual">
            <div class="mood-aura"></div>
            <div class="mood-text">
                <h2>平静</h2>
                <p id="current-time">--:--, -- --</p>
            </div>
            <p class="mood-prompt">深呼吸, 把这一刻收藏起来。</p>
        </section>

        <section class="mood-calendar">
            <div class="calendar-header">
                <button id="prev-month" class="month-nav">&lt;</button>
                <h3 id="current-month">2024年11月</h3>
                <button id="next-month" class="month-nav">&gt;</button>
                <button id="calendar-toggle" class="calendar-toggle">▼</button>
            </div>
            <div class="calendar-grid" id="calendar-grid">
                <span class="weekday">周日</span>
                <span class="weekday">周一</span>
                <span class="weekday">周二</span>
                <span class="weekday">周三</span>
                <span class="weekday">周四</span>
                <span class="weekday">周五</span>
                <span class="weekday">周六</span>
                <!-- 日期将由JavaScript动态生成 -->
            </div>
        </section>

        <section class="daily-timeline">
            <div class="timeline-header">
                <h4 id="selected-date-display">选择一个日期</h4>
                <button id="open-emotion-map-btn" class="emotion-map-btn">
                    <svg t="1731234567890" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                        <circle cx="512" cy="512" r="400" fill="none" stroke="#5C5C66" stroke-width="40"/>
                        <circle cx="512" cy="300" r="60" fill="#5C5C66"/>
                        <circle cx="300" cy="512" r="60" fill="#5C5C66"/>
                        <circle cx="724" cy="512" r="60" fill="#5C5C66"/>
                        <circle cx="512" cy="724" r="60" fill="#5C5C66"/>
                    </svg>
                </button>
            </div>
            <div class="timeline-bar" id="timeline-bar">
                <!-- 时间线将由JavaScript动态生成 -->
            </div>
            <div class="timeline-labels">
                <span>0时</span>
                <span>6时</span>
                <span>12时</span>
                <span>18时</span>
            </div>
        </section>
    </main>

    <div id="data-modal" class="modal-overlay">
        <div class="modal-content">
            <button id="close-modal-btn" class="close-btn">&times;</button>
            
            <div class="chart-section">
                <div class="chart-header">
                    <h3>心率</h3>
                </div>
                <div id="modal-hr-chart" class="modal-chart-box"></div>
            </div>
            
            <div class="chart-section">
                <div class="chart-header">
                    <h3>呼吸率</h3>
                </div>
                <div id="modal-br-chart" class="modal-chart-box"></div>
            </div>
        </div>
    </div>

    <!-- 健康指标四宫格弹窗 -->
    <div id="health-modal" class="modal-overlay">
        <div class="modal-content health-modal-content">
            <button id="close-health-modal-btn" class="close-btn">&times;</button>
            <h2 class="modal-title">我的健康</h2>
            
            <div class="health-grid">
                <div class="health-card stress-level">
                    <div class="health-icon">
                        <svg t="1762771384980" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1749" width="50" height="50"><path d="M921.799877 367.456449C835.009318 268.765378 765.493695 141.058812 703.271933 17.798943a31.990623 31.990623 0 1 0-57.103261 28.823551c64.077217 127.066754 136.056119 258.996082 227.58129 363.093568 20.02613 22.809314 40.756053 46.418394 50.065325 73.45047 21.465708 62.509677-52.464621 111.007461-98.435147 134.328625-15.131565 7.677749-30.710998 13.755968-47.186168 20.186083-29.495354 11.516624-59.982418 23.481117-89.061894 45.23474-44.6909 33.39821-75.657823 78.920866-105.569055 122.939963l-15.035593 21.881586c-29.687298 42.739472-66.540495 88.805969-114.526429 106.400812-46.290431 16.987021-102.497955 18.554561-156.850023 20.090111-20.250064 0.575831-40.180222 1.119672-59.310615 2.431287l-15.739386 1.151663c-37.748935 2.879156-70.251408 5.438406-98.08325-10.812831a60.238343 60.238343 0 0 1-26.520226-35.317647c-1.695503-6.494096-2.687212-15.995311 2.143372-24.12093 9.469224-15.89934 34.229966-19.674233 44.434975-20.56997 10.684868-0.959719 21.433717-0.767775 32.182566-0.639813 16.155264 0.191944 32.726407 0.383887 50.129306-2.239343 63.629349-9.629177 122.204179-56.303496 156.818033-124.859401 30.199148-59.918436 39.380457-127.962491 44.370994-186.601303 12.028474-141.430543 5.694331-283.916777-18.906458-423.491864a31.990623 31.990623 0 1 0-63.021527 11.068756 1577.137702 1577.137702 0 0 1 18.234655 406.984703c-4.734612 55.183824-12.540324 113.182823-37.812916 163.184166-24.888704 49.361531-66.732439 84.007375-109.247977 90.437491-12.31639 1.855456-25.592498 1.695503-39.860316 1.53555-12.764258-0.159953-25.68847-0.255925-38.452729 0.895737-42.963406 3.742903-76.297635 22.07353-93.828496 51.600875-12.572315 21.113811-15.835358 47.026215-9.117328 72.842648a123.80371 123.80371 0 0 0 56.207525 74.538151c29.687298 17.338918 60.558249 21.657652 90.277537 21.657651 15.41948 0 30.551045-1.183653 44.978816-2.303325l15.099573-1.119672a1445.208373 1445.208373 0 0 1 56.815346-2.303324c59.502558-1.663512 121.020526-3.391006 177.132079-23.992967 64.653049-23.705051 109.599874-78.984848 145.013493-129.94591l15.355498-22.393436c28.215729-41.491838 54.863918-80.712341 90.981332-107.712427 22.169502-16.571143 47.346122-26.424254 74.090282-36.853197 17.178964-6.718031 34.93376-13.659996 52.784527-22.713342 109.823808-55.759655 157.16993-133.080991 130.009891-212.193801-13.37208-38.964579-40.628091-69.995483-62.509677-94.916178z" fill="#5465CF" p-id="1750"></path><path d="M733.91895 516.212845c-8.445524 2.55925-12.34838 11.260699-9.789131 19.706224a16.475171 16.475171 0 0 0 15.931331 11.100746c1.599531 0 3.263044-0.223934 4.862574-0.703794 11.644587-3.550959 24.792733-7.581778 36.46931-15.899339 28.119757-20.154092 27.415964-56.175534 14.939621-81.12822-7.677749-15.355499-18.714514-26.008376-29.431373-36.309357a275.119356 275.119356 0 0 1-11.260699-11.32468 15.995311 15.995311 0 0 0-23.481117 21.753624c4.0948 4.382715 8.317562 8.509506 12.540324 12.604305 9.181309 8.797421 17.786786 17.114983 23.033248 27.575917 6.814003 13.628005 7.325853 31.990623-4.958546 40.788044-7.421824 5.310443-16.987021 8.22159-28.855542 11.83653z" fill="#5465CF" p-id="1751"></path></svg>
                    </div>
                    <h3>压力水平</h3>
                    <div class="health-line-icon">
                        <svg viewBox="0 0 60 30" preserveAspectRatio="none">
                            <polyline points="0,25 15,15 30,20 45,10 60,15" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="health-value" id="stress-level-value">--</div>
                    <p class="health-unit">SDNN (ms)</p>
                </div>

                <div class="health-card recovery">
                    <div class="health-icon">
                        <svg t="1762771876814" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1904" width="50" height="50"><path d="M512.02464 269.44c36.16-81.6 113.024-154.784 200.896-169.984 87.872-15.2 183.84 20.512 236.704 92.416A217.76 217.76 0 0 1 992.02464 324.352c-1.504 89.984-63.776 153.184-121.504 220.832-65.408 76.672-132.48 153.696-197.44 229.696l-111.712 130.656c-25.6 29.952-73.024 29.952-98.624 0l-111.68-130.656c-65.024-76-132.064-153.024-197.44-229.696-57.76-67.648-120-130.848-121.536-220.832a217.76 217.76 0 0 1 42.368-132.48c52.864-71.904 148.8-107.616 236.704-92.416S475.89664 187.84 512.02464 269.44z" fill="#E0EBFE" p-id="1905"></path><path d="M129.24064 565.952a29129.632 29129.632 0 0 0 104.576 121.728c31.168 36.16 62.24 72.192 92.864 108l111.68 130.656A96.64 96.64 0 0 0 512.02464 960c28.48 0 55.328-12.256 73.632-33.664l111.712-130.656c30.624-35.84 61.696-71.872 92.864-108a29129.632 29129.632 0 0 0 104.576-121.728l15.68-18.208c55.04-63.648 111.936-129.44 113.504-222.88a250.88 250.88 0 0 0-48.576-151.968C926.00864 105.728 841.01664 64 753.52864 64c-15.52 0-31.04 1.312-46.08 3.936-75.328 13.024-147.52 64.16-195.424 135.52-47.904-71.36-120.128-122.496-195.424-135.52A270.4 270.4 0 0 0 270.52064 64C183.06464 64 98.04064 105.728 48.63264 172.896a250.88 250.88 0 0 0-48.576 152c1.6 93.44 58.464 159.2 113.504 222.848l15.68 18.208zM100.18464 210.816C137.75264 159.744 203.03264 128 270.52064 128c11.872 0 23.68 0.992 35.168 2.976 71.264 12.352 142.4 73.184 177.088 151.424a32 32 0 0 0 58.528 0c34.624-78.24 105.792-139.072 177.056-151.424a206.56 206.56 0 0 1 35.2-2.976c67.456 0 132.736 31.744 170.304 82.816a186.56 186.56 0 0 1 36.128 112.992c-1.184 70.208-48.16 124.544-97.92 182.08l-15.936 18.56c-34.528 40.416-69.472 80.96-104.352 121.44-31.232 36.16-62.4 72.32-93.088 108.192l-111.68 130.656c-12.256 14.304-37.76 14.336-49.984 0l-111.68-130.656c-30.72-35.872-61.856-72-93.088-108.192-34.88-40.48-69.824-81.024-104.32-121.472l-16-18.528c-49.728-57.536-96.704-111.872-97.888-182.08a186.56 186.56 0 0 1 36.16-112.992z" fill="#5465CF" p-id="1906"></path><path d="M178.80864 326.24c0-44.128 35.904-80 80-80a16 16 0 1 0 0-32c-61.76 0-112 50.24-112 112a16 16 0 1 0 32 0z" fill="#5465CF" p-id="1907"></path></svg>
                    </div>
                    <h3>压力调节恢复能力</h3>
                    <div class="health-line-icon">
                        <svg viewBox="0 0 60 30" preserveAspectRatio="none">
                            <polyline points="0,20 15,8 30,15 45,5 60,12" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="health-value" id="recovery-value">--</div>
                    <p class="health-unit">Valence</p>
                </div>

                <div class="health-card balance">
                    <div class="health-icon">
                        <svg t="1762772064438" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2060" width="50" height="50"><path d="M880.64 484.032a704.256 704.256 0 0 0-263.968-94.976 32 32 0 1 0-24.736 56.64c105.12 84.288 168.992 223.552 166.72 363.456-0.8 48.736-10.176 84.096-28.672 108.096-27.424 35.584-76.16 45.088-112.608 42.24-47.616-3.84-95.584-25.28-139.392-44.928-36.864-16.448-71.648-32-102.208-54.272-33.28-24.256-55.808-51.936-66.88-82.304a31.968 31.968 0 0 0-11.52-15.136c-60.64-43.136-87.456-117.44-99.296-172.16-13.888-64.416-3.712-130.304 28.8-185.536a254.624 254.624 0 0 1 37.92-50.304c31.648-31.968 41.184-60.128 35.296-103.968a609.28 609.28 0 0 0-54.88-182.912 32.032 32.032 0 0 0-57.696 27.744c24.96 51.808 41.472 106.88 49.152 163.712 3.232 24.064 0.32 32.576-17.344 50.432a319.04 319.04 0 0 0-47.648 62.88c-40.64 69.12-53.44 151.296-36.16 231.488 19.52 90.24 59.84 160.864 116.896 204.928 16.32 38.784 45.12 73.344 85.664 102.88 36.032 26.24 75.52 43.904 115.264 61.632 47.008 21.024 100.288 44.896 158.912 49.6 6.304 0.512 12.544 0.768 18.784 0.768 61.44 0 116.416-24.64 149.632-67.744 27.2-35.328 40.928-83.104 41.984-146.112 1.984-120.416-39.36-240.576-111.552-333.696a633.76 633.76 0 0 1 136.256 62.24 32 32 0 0 0 33.28-54.688z" fill="#5465CF" p-id="2061"></path><path d="M356.992 365.984a32 32 0 0 0 63.808 4.8c5.12-67.392 41.6-130.56 95.36-166.24a206.4 206.4 0 0 0 113.504 2.912c44-11.68 81.664-39.328 100.736-73.92a32 32 0 1 0-56.064-30.88c-10.656 19.328-34.048 35.776-61.12 42.976a140.8 140.8 0 0 1-72.064-0.64c5.344-46.016-4.096-93.28-27.328-130.08a32 32 0 0 0-54.144 34.176c18.56 29.312 24 69.12 15.008 106.08-66.592 47.008-111.328 126.624-117.696 210.816z" fill="#5465CF" p-id="2062"></path></svg>
                    </div>
                    <h3>自主神经平衡</h3>
                    <div class="health-line-icon">
                        <svg viewBox="0 0 60 30" preserveAspectRatio="none">
                            <polyline points="0,18 15,22 30,15 45,20 60,16" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="health-value" id="balance-value">--</div>
                    <p class="health-unit">LF/HF Ratio</p>
                </div>

                <div class="health-card activity">
                    <div class="health-icon">
                        <svg t="1762772098926" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2215" width="50" height="50"><path d="M512 453.376c10.848-25.12 33.92-47.648 60.256-52.32 26.368-4.672 55.168 6.336 71.04 28.448 8.576 12 12.928 26.368 12.704 40.768-0.448 27.68-19.136 47.136-36.48 67.936-19.616 23.584-39.712 47.296-59.2 70.688l-33.536 40.192a19.296 19.296 0 0 1-29.568 0l-33.536-40.192c-19.488-23.392-39.584-47.104-59.2-70.688-17.344-20.8-36.032-40.256-36.48-67.936-0.224-14.4 4.128-28.8 12.704-40.768 15.872-22.112 44.672-33.12 71.04-28.448 26.336 4.672 49.408 27.2 60.256 52.32z" fill="#E0EBFE" p-id="2216"></path><path d="M484.896 659.328a35.2 35.2 0 0 0 54.176 0l97.504-116.512c16.352-19.424 34.88-41.472 35.424-72.32a84.608 84.608 0 0 0-15.712-50.304c-18.816-26.304-54.048-40.704-86.784-34.88-21.632 3.84-42.368 17.504-57.504 36.928-15.136-19.424-35.872-33.088-57.504-36.928-32.736-5.824-67.968 8.576-86.784 34.88A84.704 84.704 0 0 0 352 470.496c0.544 30.816 19.072 52.864 35.424 72.288l97.472 116.512z m-91.2-220.512c10.112-14.08 27.68-22.816 45.824-22.816a54.4 54.4 0 0 1 9.408 0.8c19.328 3.456 38.784 20.672 48.384 42.912 5.056 11.712 24.32 11.712 29.376 0 9.6-22.24 29.056-39.456 48.384-42.88 20.832-3.744 43.36 5.44 55.2 21.984 6.432 8.96 9.888 20.064 9.728 31.168-0.32 19.456-13.12 34.656-27.904 52.224l-97.6 116.64A3.136 3.136 0 0 1 512 640l-100.096-117.792c-14.784-17.6-27.584-32.768-27.904-52.192a52.608 52.608 0 0 1 9.728-31.2z" fill="#5465CF" p-id="2217"></path><path d="M640 0h-256a32 32 0 0 0-32 32v192H288a32 32 0 0 0-32 32v512a32 32 0 0 0 32 32h64v192a32 32 0 0 0 32 32h256a32 32 0 0 0 32-32v-192h64a32 32 0 0 0 32-32V256a32 32 0 0 0-32-32h-64V32a32 32 0 0 0-32-32z m-224 64h192v160h-192V64z m192 896h-192v-160h192v160z m96-672v448H320V288h384z" fill="#5465CF" p-id="2218"></path></svg>
                    </div>
                    <h3>自主神经活性</h3>
                    <div class="health-line-icon">
                        <svg viewBox="0 0 60 30" preserveAspectRatio="none">
                            <polyline points="0,15 15,10 30,18 45,8 60,14" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="health-value" id="activity-value">--</div>
                    <p class="health-unit">Arousal</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 情绪图谱弹窗 -->
    <div id="emotion-map-modal" class="modal-overlay">
        <div class="modal-content emotion-map-modal-content">
            <button id="close-emotion-map-btn" class="close-btn">&times;</button>
            <h2 class="modal-title">我的情绪图谱</h2>
            
            <div class="emotion-map-container">
                <canvas id="emotion-map-canvas"></canvas>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>